{% extends "base.html" %}

{% block title %}ì—¬í–‰ì—ì„œì˜ ìœ¤ë¦¬ì  ì†Œë¹„ - ì†Œë¹„ ë‚´ì—­ ì¶”ê°€í•˜ê¸°{% endblock %}

{% block content %}
<div class="page-container">
    <!-- ë‹«ê¸°(X) ì•„ì´ì½˜ -->
    <div class="close-section">
        <button id="close-btn" onclick="history.back()">
            <img src="{{ url_for('static', filename='images/flat_icon/close-darkest-navy.png') }}" alt="ë‹«ê¸°">
        </button>
    </div>

    <!-- íƒ€ì´í‹€ -->
    <h2>ğŸ’¸ ì†Œë¹„ ë‚´ì—­ ì¶”ê°€í•˜ê¸° ğŸ’¸</h2>

    <!-- ì—¬í–‰ ë°ì´í„° ì…ë ¥ í¼ -->
    <form action="{{ url_for('main.add_consumption') }}" method="POST">
        <div class="input-section">
            <label for="consume-name">*ì†Œë¹„ì²˜:</label>
            <input type="text" id="consume-name" name="consume-name" placeholder="e.g. ê³µí•­ ë©´ì„¸ì " required>    
        </div>
        <div class="input-section">
            <label for="consume-description">ì„¤ëª…:</label>
            <input type="text" id="consume-description" name="consume-description" placeholder="e.g. ë§ê³  ì ¤ë¦¬ 3ë´‰ì§€">
        </div>
        <div class="input-section">
            <label for="amount-exchanged">*ê°€ê²©:</label>
            <input type="text" id="amount-exchanged" name="amount-exchanged" required>
        </div>
        <div class="input-section">
            <label for="category">*ë¶„ë¥˜:</label>
            <select id="category" name="category" required>
                <option value="ì‹ë¹„">ì‹ë¹„</option>
                <option value="êµí†µ">êµí†µë¹„</option>
                <option value="ìˆ™ë°•">ìˆ™ë°•ë¹„</option>
                <option value="ê´€ê´‘">ê´€ê´‘ (ì…ì¥ë£Œ, ì²´í—˜, ëŒ€ì—¬ ë“±)</option>
                <option value="ì‡¼í•‘">ì‡¼í•‘ (ê¸°ë…í’ˆ, ì„ ë¬¼ ë“±)</option>
                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>
        </div>
        <div class="input-section">
            <label for="payment">ê²°ì œ ìˆ˜ë‹¨:</label>
            <select id="payment" name="payment">
                <option value="í˜„ê¸ˆ">í˜„ê¸ˆ</option>
                <option value="ì¹´ë“œ">ì¹´ë“œ</option>
                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>
        </div>
        <div class="input-section">
            <label for="memo">ê¸°íƒ€ ë©”ëª¨:</label>
            <input type="text" id="memo" name="memo" placeholder="(ì„ íƒ)">
        </div>
        
        <!-- ì˜¤ë¥˜ ë©”ì‹œì§€ -->
        {% if error %}
            <p class="error-message">{{ error }}</p>
        {% endif %}

        <!-- ì¶”ê°€í•˜ê¸° ë²„íŠ¼ -->
        <button class="submit" type="submit">ì¶”ê°€</button>
    </form>
</div>

<!-- ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    const input = document.querySelector('#budget-exchanged');
    const form = document.querySelector('form'); // í¼ ì„ íƒ

    input.addEventListener('input', function (e) {
        // ì…ë ¥ê°’ì—ì„œ ì‰¼í‘œ ì œê±° í›„ ìˆ«ìë¡œ ë³€í™˜
        let value = e.target.value.replaceAll(',', '');

        // ìˆ«ìê°€ ì•„ë‹Œ ê²½ìš° ë¹ˆ ê°’ ì²˜ë¦¬
        if (isNaN(value) || value === '') {
            input.value = '';
            return;
        }

        // ìˆ«ìë¥¼ ì²œ ë‹¨ìœ„ë¡œ ì‰¼í‘œ ì¶”ê°€í•˜ì—¬ í‘œì‹œ
        const formattedValue = parseInt(value, 10).toLocaleString('ko-KR');
        input.value = formattedValue;
    });

    form.addEventListener('submit', function () {
        // ì‰¼í‘œë¥¼ ì œê±°í•œ ê°’ì„ ì„œë²„ë¡œ ì „ì†¡
        const rawValue = input.value.replaceAll(',', '');
        input.value = rawValue;
    });
</script>

<!-- ìŠ¤íƒ€ì¼ -->
<style>
    .page-container {
        display: flex;
        flex-direction: column;
    }

    /* ë‹«ê¸° ë²„íŠ¼ ì„¹ì…˜ */
    .close-section {
        padding: 30px;
        display: flex;
        justify-content: flex-end;
    }

    #close-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0;
    }

    #close-btn img {
        width: 16px;
    }

    /* íƒ€ì´í‹€ */
    h2 {
        margin: 0 auto 20px;
    }

    /* í¼ ì„¹ì…˜ */
    form {
        padding: 0 0 60px;
        display: flexbox;
        text-align: right;
        margin: 0 auto;
        justify-content: center;
    }

    .input-section {
        margin: 20px auto;
    }

    label {
        font-size: 16px;
        font-weight: bold;
        color: var(--color-darkest-bluegrey);
        margin-right: 10px;
    }

    input, select {
        background-color: var(--color-white);
        font-size: 14px;
        color: var(--color-darkest-bluegrey);
        padding: 8px;
        width: 200px;
        height: 40px;
        border: 1px solid var(--color-bluegrey);
        border-radius: 5px;
        box-sizing: border-box;
    }

    .error-message {
        color: var(--color-dark-pink);
        font-weight: bold;
        padding: 16px 0;
    }

    .submit {
        background: var(--color-white);
        height: 40px;
        width: 250px;
        border-radius: 8px;
        color: var(--color-darkest-navy);
        font-size: 16px;
        font-weight: 500;
        border: 1.5px solid var(--color-darkest-navy);
        margin: 30px 0;
    }
</style>
{% endblock %}
